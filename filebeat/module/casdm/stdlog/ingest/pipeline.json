{
  "description": "Pipeline for parsing casdm stdlog logs",
  "processors": [
	{
		"grok": {
			"field": "message",
			"patterns": [
				"%{TIMESTAMP:casdm.stdlog.timestamp}%{SPACE}%{HOSTNAME:casdm.stdlog.hostname}%{SPACE}%{PROCESS:casdm.stdlog.process.name}%{SPACE}%{PID:casdm.stdlog.process.id}%{SPACE}%{LOGLEVEL:casdm.stdlog.level}%{SPACE}%{FILENAME:casdm.stdlog.file.name}%{SPACE}%{POSINT:casdm.stdlog.file.line}%{SPACE}%{DATA:casdm.stdlog.message}"
			],
			"pattern_definitions": {
				"TIMESTAMP": "%{MONTHNUM2}/%{MONTHDAY} %{HOUR}:%{MINUTE}:%{SECOND}",
        "PROCESS": "%{USERNAME}",
        "PID": "%{POSINT}",
        "LOGLEVEL": "(FATAL|EXIT|SIGNIFICANT|SEVERE_ERROR|ERROR|WARNING|INFORMATION|MILESTONE|TRACE|VERBOSE)",
        "FILENAME": "(?:[A-Za-z0-9_. -]+)"
			}
		}
	}
  ],
  "on_failure" : [{
    "set" : {
      "field" : "error.message",
      "value" : "{{ _ingest.on_failure_message }}"
    }
  }]
}
